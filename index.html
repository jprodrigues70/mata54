<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Interpolação</title>
    <link rel="stylesheet" href="nm/gaintime/css/gaintime.min.css">
  </head>
  <body>
    <section>
      <div class="row flex-box">
        <div class="xs-12 sm-6">
          <h1>Busca por interpolação</h1>
          <form id="bpi" class="gt-form">
            <label for="array">Insira os inteiros do seu arquivo separados por vírgula</label>
            <input type="text" name="array" id="array">
            <label for="x">Insira o inteiro que está procurando</label>
            <input type="number" name="x" id="x">
            <button class="btn success" type="submit" name="button">Buscar</button>
          </form>
        </div>
        <div class="xs-12 sm-6">
          <h2>Resultado</h2>
          <form class="gt-form" action="index.html" method="post">
            <label for="bpi_position">Posição</label>
            <input id="bpi_position" type="text" name="bpi_position" disabled>
            <label for="bpi_comparison">Comparações</label>
            <textarea id="bpi_comparison" name="name" rows="4" disabled></textarea>
          </form>
        </div>
      </div>
    </section>
    <section>
      <div class="row flex-box">
        <div class="xs-12 sm-6">
          <h1>Busca Binária</h1>
          <form id="bb" class="gt-form">
            <label for="array">Insira os inteiros do seu arquivo separados por vírgula</label>
            <input type="text" name="array" id="array">
            <label for="x">Insira o inteiro que está procurando</label>
            <input type="number" name="x" id="x">
            <button class="btn success" type="submit" name="button">Buscar</button>
          </form>
        </div>
        <div class="xs-12 sm-6">
          <h2>Resultado</h2>
          <form class="gt-form" action="index.html" method="post">
            <label for="bb_position">Posição</label>
            <input id="bb_position" type="text" name="bpi_position" disabled>
            <label for="bb_comparison">Comparações</label>
            <textarea id="bb_comparison" name="name" rows="4" disabled></textarea>
          </form>
        </div>
      </div>
    </section>

    <script type="text/javascript">
      var bpi = document.getElementById("bpi");
      bpi.addEventListener("submit", function(e) {
        e.preventDefault();
        array = e.target[0].value.replace(" ", "").split(",").map(function(x) { return parseInt(x) });
        x = parseInt(e.target[1].value) || 0;
        bpi_position = interpolation(array, x);
        document.getElementById("bpi_position").value = (bpi_position > -1)? bpi_position: "Não encontrado"
      });

      function interpolation(A, x) {
        var c, m, n = A.length,
        i = 0
        f = n -1;

        c = ("i = " + i + ", f = " + f + ": " + x + " > " + A[i] + " && " + x + " <= " + A[f] + "?\r\n");
        while (x > A[i] && x <= A[f]) {
          m = Math.round(i + ((x - A[i])/(A[f] - A[i])) * (f - 1));
          if (x > A[m]) {
            i = m + 1;
          } else if (x < A[m]) {
            f = m - 1;
          } else {
            i = m
          }
          c = c + ("i = " + i + ", f = " + f + ": " + x + " > " + A[i] + " && " + x + " <= " + A[f] + "?\r\n")
        }
        document.getElementById("bpi_comparison").value = c;
        return (A[i] == x)? i: -1;
      }

      var bb = document.getElementById("bb");
      bb.addEventListener("submit", function(e) {
        e.preventDefault();
        array = e.target[0].value.replace(" ", "").split(",").map(function(x) { return parseInt(x) });
        x = parseInt(e.target[1].value) || 0;
        bb_position = binarySearch(array, x);
        document.getElementById("bb_position").value = (bb_position > -1)? bb_position: "Não encontrado"
      });

      function binarySearch(A, x) {
        var c, m, n = A.length, i = 0, f = n - 1;

        c = ("i = " + i + ", f = " + f + ": " + x + " > " + A[i] + " && " + x + " <= " + A[f] + "?\r\n");
        while (i <= f) {
          m = Math.round((i + f) / 2);
          if (A[m] == x) {
            document.getElementById("bb_comparison").value = c;
            return m;
          } else if (x < A[m]) {
            f = m - 1;
          } else {
            i = m + 1;
          }
          c = c + ("i = " + i + ", f = " + f + ": " + x + " > " + A[i] + " && " + x + " <= " + A[f] + "?\r\n")
        }
        document.getElementById("bb_comparison").value = c;
        return -1;
      }
    </script>
  </body>
</html>
